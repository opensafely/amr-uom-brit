from cohortextractor import filter_codes_by_category, patients, combine_codelists
from codelists import *
from datetime import datetime, timedelta

def generate_antibiotics_yr3(index_date_variable):
    antibiotics_yr3 = dict(

# select top 11 common ab


# 3 yr before index
Rx_25_Amoxicillin=patients.with_these_medications(codes_ab_type_Amoxicillin,between=[f'{index_date_variable}-792days', f'{index_date_variable}-763days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_25_Azithromycin=patients.with_these_medications(codes_ab_type_Amoxicillin,between=[f'{index_date_variable}-792days', f'{index_date_variable}-763days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_25_Cefalexin=patients.with_these_medications(codes_ab_type_Amoxicillin,between=[f'{index_date_variable}-792days', f'{index_date_variable}-763days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_25_Ciprofloxacin=patients.with_these_medications(codes_ab_type_Amoxicillin,between=[f'{index_date_variable}-792days', f'{index_date_variable}-763days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_25_Clarithromycin=patients.with_these_medications(codes_ab_type_Amoxicillin,between=[f'{index_date_variable}-792days', f'{index_date_variable}-763days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_25_Co_amoxiclav=patients.with_these_medications(codes_ab_type_Amoxicillin,between=[f'{index_date_variable}-792days', f'{index_date_variable}-763days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_25_Doxycycline=patients.with_these_medications(codes_ab_type_Amoxicillin,between=[f'{index_date_variable}-792days', f'{index_date_variable}-763days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_25_Flucloxacillin=patients.with_these_medications(codes_ab_type_Amoxicillin,between=[f'{index_date_variable}-792days', f'{index_date_variable}-763days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_25_Nitrofurantoin=patients.with_these_medications(codes_ab_type_Amoxicillin,between=[f'{index_date_variable}-792days', f'{index_date_variable}-763days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_25_Phenoxymethylpenicillin=patients.with_these_medications(codes_ab_type_Amoxicillin,between=[f'{index_date_variable}-792days', f'{index_date_variable}-763days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_25_Trimethoprim=patients.with_these_medications(codes_ab_type_Amoxicillin,between=[f'{index_date_variable}-792days', f'{index_date_variable}-763days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_26_Amoxicillin=patients.with_these_medications(codes_ab_type_Amoxicillin,between=[f'{index_date_variable}-822days', f'{index_date_variable}-793days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_26_Azithromycin=patients.with_these_medications(codes_ab_type_Amoxicillin,between=[f'{index_date_variable}-822days', f'{index_date_variable}-793days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_26_Cefalexin=patients.with_these_medications(codes_ab_type_Amoxicillin,between=[f'{index_date_variable}-822days', f'{index_date_variable}-793days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_26_Ciprofloxacin=patients.with_these_medications(codes_ab_type_Amoxicillin,between=[f'{index_date_variable}-822days', f'{index_date_variable}-793days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_26_Clarithromycin=patients.with_these_medications(codes_ab_type_Amoxicillin,between=[f'{index_date_variable}-822days', f'{index_date_variable}-793days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_26_Co_amoxiclav=patients.with_these_medications(codes_ab_type_Amoxicillin,between=[f'{index_date_variable}-822days', f'{index_date_variable}-793days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_26_Doxycycline=patients.with_these_medications(codes_ab_type_Amoxicillin,between=[f'{index_date_variable}-822days', f'{index_date_variable}-793days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_26_Flucloxacillin=patients.with_these_medications(codes_ab_type_Amoxicillin,between=[f'{index_date_variable}-822days', f'{index_date_variable}-793days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_26_Nitrofurantoin=patients.with_these_medications(codes_ab_type_Amoxicillin,between=[f'{index_date_variable}-822days', f'{index_date_variable}-793days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_26_Phenoxymethylpenicillin=patients.with_these_medications(codes_ab_type_Amoxicillin,between=[f'{index_date_variable}-822days', f'{index_date_variable}-793days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_26_Trimethoprim=patients.with_these_medications(codes_ab_type_Amoxicillin,between=[f'{index_date_variable}-822days', f'{index_date_variable}-793days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_27_Amoxicillin=patients.with_these_medications(codes_ab_type_Amoxicillin,between=[f'{index_date_variable}-852days', f'{index_date_variable}-823days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_27_Azithromycin=patients.with_these_medications(codes_ab_type_Amoxicillin,between=[f'{index_date_variable}-852days', f'{index_date_variable}-823days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_27_Cefalexin=patients.with_these_medications(codes_ab_type_Amoxicillin,between=[f'{index_date_variable}-852days', f'{index_date_variable}-823days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_27_Ciprofloxacin=patients.with_these_medications(codes_ab_type_Amoxicillin,between=[f'{index_date_variable}-852days', f'{index_date_variable}-823days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_27_Clarithromycin=patients.with_these_medications(codes_ab_type_Amoxicillin,between=[f'{index_date_variable}-852days', f'{index_date_variable}-823days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_27_Co_amoxiclav=patients.with_these_medications(codes_ab_type_Amoxicillin,between=[f'{index_date_variable}-852days', f'{index_date_variable}-823days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_27_Doxycycline=patients.with_these_medications(codes_ab_type_Amoxicillin,between=[f'{index_date_variable}-852days', f'{index_date_variable}-823days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_27_Flucloxacillin=patients.with_these_medications(codes_ab_type_Amoxicillin,between=[f'{index_date_variable}-852days', f'{index_date_variable}-823days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_27_Nitrofurantoin=patients.with_these_medications(codes_ab_type_Amoxicillin,between=[f'{index_date_variable}-852days', f'{index_date_variable}-823days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_27_Phenoxymethylpenicillin=patients.with_these_medications(codes_ab_type_Amoxicillin,between=[f'{index_date_variable}-852days', f'{index_date_variable}-823days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_27_Trimethoprim=patients.with_these_medications(codes_ab_type_Amoxicillin,between=[f'{index_date_variable}-852days', f'{index_date_variable}-823days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_28_Amoxicillin=patients.with_these_medications(codes_ab_type_Amoxicillin,between=[f'{index_date_variable}-882days', f'{index_date_variable}-853days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_28_Azithromycin=patients.with_these_medications(codes_ab_type_Amoxicillin,between=[f'{index_date_variable}-882days', f'{index_date_variable}-853days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_28_Cefalexin=patients.with_these_medications(codes_ab_type_Amoxicillin,between=[f'{index_date_variable}-882days', f'{index_date_variable}-853days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_28_Ciprofloxacin=patients.with_these_medications(codes_ab_type_Amoxicillin,between=[f'{index_date_variable}-882days', f'{index_date_variable}-853days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_28_Clarithromycin=patients.with_these_medications(codes_ab_type_Amoxicillin,between=[f'{index_date_variable}-882days', f'{index_date_variable}-853days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_28_Co_amoxiclav=patients.with_these_medications(codes_ab_type_Amoxicillin,between=[f'{index_date_variable}-882days', f'{index_date_variable}-853days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_28_Doxycycline=patients.with_these_medications(codes_ab_type_Amoxicillin,between=[f'{index_date_variable}-882days', f'{index_date_variable}-853days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_28_Flucloxacillin=patients.with_these_medications(codes_ab_type_Amoxicillin,between=[f'{index_date_variable}-882days', f'{index_date_variable}-853days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_28_Nitrofurantoin=patients.with_these_medications(codes_ab_type_Amoxicillin,between=[f'{index_date_variable}-882days', f'{index_date_variable}-853days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_28_Phenoxymethylpenicillin=patients.with_these_medications(codes_ab_type_Amoxicillin,between=[f'{index_date_variable}-882days', f'{index_date_variable}-853days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_28_Trimethoprim=patients.with_these_medications(codes_ab_type_Amoxicillin,between=[f'{index_date_variable}-882days', f'{index_date_variable}-853days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_29_Amoxicillin=patients.with_these_medications(codes_ab_type_Amoxicillin,between=[f'{index_date_variable}-912days', f'{index_date_variable}-883days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_29_Azithromycin=patients.with_these_medications(codes_ab_type_Amoxicillin,between=[f'{index_date_variable}-912days', f'{index_date_variable}-883days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_29_Cefalexin=patients.with_these_medications(codes_ab_type_Amoxicillin,between=[f'{index_date_variable}-912days', f'{index_date_variable}-883days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_29_Ciprofloxacin=patients.with_these_medications(codes_ab_type_Amoxicillin,between=[f'{index_date_variable}-912days', f'{index_date_variable}-883days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_29_Clarithromycin=patients.with_these_medications(codes_ab_type_Amoxicillin,between=[f'{index_date_variable}-912days', f'{index_date_variable}-883days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_29_Co_amoxiclav=patients.with_these_medications(codes_ab_type_Amoxicillin,between=[f'{index_date_variable}-912days', f'{index_date_variable}-883days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_29_Doxycycline=patients.with_these_medications(codes_ab_type_Amoxicillin,between=[f'{index_date_variable}-912days', f'{index_date_variable}-883days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_29_Flucloxacillin=patients.with_these_medications(codes_ab_type_Amoxicillin,between=[f'{index_date_variable}-912days', f'{index_date_variable}-883days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_29_Nitrofurantoin=patients.with_these_medications(codes_ab_type_Amoxicillin,between=[f'{index_date_variable}-912days', f'{index_date_variable}-883days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_29_Phenoxymethylpenicillin=patients.with_these_medications(codes_ab_type_Amoxicillin,between=[f'{index_date_variable}-912days', f'{index_date_variable}-883days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_29_Trimethoprim=patients.with_these_medications(codes_ab_type_Amoxicillin,between=[f'{index_date_variable}-912days', f'{index_date_variable}-883days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_30_Amoxicillin=patients.with_these_medications(codes_ab_type_Amoxicillin,between=[f'{index_date_variable}-942days', f'{index_date_variable}-913days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_30_Azithromycin=patients.with_these_medications(codes_ab_type_Amoxicillin,between=[f'{index_date_variable}-942days', f'{index_date_variable}-913days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_30_Cefalexin=patients.with_these_medications(codes_ab_type_Amoxicillin,between=[f'{index_date_variable}-942days', f'{index_date_variable}-913days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_30_Ciprofloxacin=patients.with_these_medications(codes_ab_type_Amoxicillin,between=[f'{index_date_variable}-942days', f'{index_date_variable}-913days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_30_Clarithromycin=patients.with_these_medications(codes_ab_type_Amoxicillin,between=[f'{index_date_variable}-942days', f'{index_date_variable}-913days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_30_Co_amoxiclav=patients.with_these_medications(codes_ab_type_Amoxicillin,between=[f'{index_date_variable}-942days', f'{index_date_variable}-913days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_30_Doxycycline=patients.with_these_medications(codes_ab_type_Amoxicillin,between=[f'{index_date_variable}-942days', f'{index_date_variable}-913days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_30_Flucloxacillin=patients.with_these_medications(codes_ab_type_Amoxicillin,between=[f'{index_date_variable}-942days', f'{index_date_variable}-913days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_30_Nitrofurantoin=patients.with_these_medications(codes_ab_type_Amoxicillin,between=[f'{index_date_variable}-942days', f'{index_date_variable}-913days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_30_Phenoxymethylpenicillin=patients.with_these_medications(codes_ab_type_Amoxicillin,between=[f'{index_date_variable}-942days', f'{index_date_variable}-913days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_30_Trimethoprim=patients.with_these_medications(codes_ab_type_Amoxicillin,between=[f'{index_date_variable}-942days', f'{index_date_variable}-913days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_31_Amoxicillin=patients.with_these_medications(codes_ab_type_Amoxicillin,between=[f'{index_date_variable}-972days', f'{index_date_variable}-943days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_31_Azithromycin=patients.with_these_medications(codes_ab_type_Amoxicillin,between=[f'{index_date_variable}-972days', f'{index_date_variable}-943days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_31_Cefalexin=patients.with_these_medications(codes_ab_type_Amoxicillin,between=[f'{index_date_variable}-972days', f'{index_date_variable}-943days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_31_Ciprofloxacin=patients.with_these_medications(codes_ab_type_Amoxicillin,between=[f'{index_date_variable}-972days', f'{index_date_variable}-943days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_31_Clarithromycin=patients.with_these_medications(codes_ab_type_Amoxicillin,between=[f'{index_date_variable}-972days', f'{index_date_variable}-943days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_31_Co_amoxiclav=patients.with_these_medications(codes_ab_type_Amoxicillin,between=[f'{index_date_variable}-972days', f'{index_date_variable}-943days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_31_Doxycycline=patients.with_these_medications(codes_ab_type_Amoxicillin,between=[f'{index_date_variable}-972days', f'{index_date_variable}-943days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_31_Flucloxacillin=patients.with_these_medications(codes_ab_type_Amoxicillin,between=[f'{index_date_variable}-972days', f'{index_date_variable}-943days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_31_Nitrofurantoin=patients.with_these_medications(codes_ab_type_Amoxicillin,between=[f'{index_date_variable}-972days', f'{index_date_variable}-943days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_31_Phenoxymethylpenicillin=patients.with_these_medications(codes_ab_type_Amoxicillin,between=[f'{index_date_variable}-972days', f'{index_date_variable}-943days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_31_Trimethoprim=patients.with_these_medications(codes_ab_type_Amoxicillin,between=[f'{index_date_variable}-972days', f'{index_date_variable}-943days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_32_Amoxicillin=patients.with_these_medications(codes_ab_type_Amoxicillin,between=[f'{index_date_variable}-1002days', f'{index_date_variable}-973days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_32_Azithromycin=patients.with_these_medications(codes_ab_type_Amoxicillin,between=[f'{index_date_variable}-1002days', f'{index_date_variable}-973days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_32_Cefalexin=patients.with_these_medications(codes_ab_type_Amoxicillin,between=[f'{index_date_variable}-1002days', f'{index_date_variable}-973days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_32_Ciprofloxacin=patients.with_these_medications(codes_ab_type_Amoxicillin,between=[f'{index_date_variable}-1002days', f'{index_date_variable}-973days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_32_Clarithromycin=patients.with_these_medications(codes_ab_type_Amoxicillin,between=[f'{index_date_variable}-1002days', f'{index_date_variable}-973days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_32_Co_amoxiclav=patients.with_these_medications(codes_ab_type_Amoxicillin,between=[f'{index_date_variable}-1002days', f'{index_date_variable}-973days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_32_Doxycycline=patients.with_these_medications(codes_ab_type_Amoxicillin,between=[f'{index_date_variable}-1002days', f'{index_date_variable}-973days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_32_Flucloxacillin=patients.with_these_medications(codes_ab_type_Amoxicillin,between=[f'{index_date_variable}-1002days', f'{index_date_variable}-973days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_32_Nitrofurantoin=patients.with_these_medications(codes_ab_type_Amoxicillin,between=[f'{index_date_variable}-1002days', f'{index_date_variable}-973days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_32_Phenoxymethylpenicillin=patients.with_these_medications(codes_ab_type_Amoxicillin,between=[f'{index_date_variable}-1002days', f'{index_date_variable}-973days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_32_Trimethoprim=patients.with_these_medications(codes_ab_type_Amoxicillin,between=[f'{index_date_variable}-1002days', f'{index_date_variable}-973days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_33_Amoxicillin=patients.with_these_medications(codes_ab_type_Amoxicillin,between=[f'{index_date_variable}-1032days', f'{index_date_variable}-1003days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_33_Azithromycin=patients.with_these_medications(codes_ab_type_Amoxicillin,between=[f'{index_date_variable}-1032days', f'{index_date_variable}-1003days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_33_Cefalexin=patients.with_these_medications(codes_ab_type_Amoxicillin,between=[f'{index_date_variable}-1032days', f'{index_date_variable}-1003days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_33_Ciprofloxacin=patients.with_these_medications(codes_ab_type_Amoxicillin,between=[f'{index_date_variable}-1032days', f'{index_date_variable}-1003days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_33_Clarithromycin=patients.with_these_medications(codes_ab_type_Amoxicillin,between=[f'{index_date_variable}-1032days', f'{index_date_variable}-1003days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_33_Co_amoxiclav=patients.with_these_medications(codes_ab_type_Amoxicillin,between=[f'{index_date_variable}-1032days', f'{index_date_variable}-1003days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_33_Doxycycline=patients.with_these_medications(codes_ab_type_Amoxicillin,between=[f'{index_date_variable}-1032days', f'{index_date_variable}-1003days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_33_Flucloxacillin=patients.with_these_medications(codes_ab_type_Amoxicillin,between=[f'{index_date_variable}-1032days', f'{index_date_variable}-1003days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_33_Nitrofurantoin=patients.with_these_medications(codes_ab_type_Amoxicillin,between=[f'{index_date_variable}-1032days', f'{index_date_variable}-1003days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_33_Phenoxymethylpenicillin=patients.with_these_medications(codes_ab_type_Amoxicillin,between=[f'{index_date_variable}-1032days', f'{index_date_variable}-1003days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_33_Trimethoprim=patients.with_these_medications(codes_ab_type_Amoxicillin,between=[f'{index_date_variable}-1032days', f'{index_date_variable}-1003days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_34_Amoxicillin=patients.with_these_medications(codes_ab_type_Amoxicillin,between=[f'{index_date_variable}-1062days', f'{index_date_variable}-1033days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_34_Azithromycin=patients.with_these_medications(codes_ab_type_Amoxicillin,between=[f'{index_date_variable}-1062days', f'{index_date_variable}-1033days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_34_Cefalexin=patients.with_these_medications(codes_ab_type_Amoxicillin,between=[f'{index_date_variable}-1062days', f'{index_date_variable}-1033days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_34_Ciprofloxacin=patients.with_these_medications(codes_ab_type_Amoxicillin,between=[f'{index_date_variable}-1062days', f'{index_date_variable}-1033days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_34_Clarithromycin=patients.with_these_medications(codes_ab_type_Amoxicillin,between=[f'{index_date_variable}-1062days', f'{index_date_variable}-1033days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_34_Co_amoxiclav=patients.with_these_medications(codes_ab_type_Amoxicillin,between=[f'{index_date_variable}-1062days', f'{index_date_variable}-1033days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_34_Doxycycline=patients.with_these_medications(codes_ab_type_Amoxicillin,between=[f'{index_date_variable}-1062days', f'{index_date_variable}-1033days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_34_Flucloxacillin=patients.with_these_medications(codes_ab_type_Amoxicillin,between=[f'{index_date_variable}-1062days', f'{index_date_variable}-1033days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_34_Nitrofurantoin=patients.with_these_medications(codes_ab_type_Amoxicillin,between=[f'{index_date_variable}-1062days', f'{index_date_variable}-1033days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_34_Phenoxymethylpenicillin=patients.with_these_medications(codes_ab_type_Amoxicillin,between=[f'{index_date_variable}-1062days', f'{index_date_variable}-1033days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_34_Trimethoprim=patients.with_these_medications(codes_ab_type_Amoxicillin,between=[f'{index_date_variable}-1062days', f'{index_date_variable}-1033days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_35_Amoxicillin=patients.with_these_medications(codes_ab_type_Amoxicillin,between=[f'{index_date_variable}-1092days', f'{index_date_variable}-1063days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_35_Azithromycin=patients.with_these_medications(codes_ab_type_Amoxicillin,between=[f'{index_date_variable}-1092days', f'{index_date_variable}-1063days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_35_Cefalexin=patients.with_these_medications(codes_ab_type_Amoxicillin,between=[f'{index_date_variable}-1092days', f'{index_date_variable}-1063days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_35_Ciprofloxacin=patients.with_these_medications(codes_ab_type_Amoxicillin,between=[f'{index_date_variable}-1092days', f'{index_date_variable}-1063days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_35_Clarithromycin=patients.with_these_medications(codes_ab_type_Amoxicillin,between=[f'{index_date_variable}-1092days', f'{index_date_variable}-1063days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_35_Co_amoxiclav=patients.with_these_medications(codes_ab_type_Amoxicillin,between=[f'{index_date_variable}-1092days', f'{index_date_variable}-1063days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_35_Doxycycline=patients.with_these_medications(codes_ab_type_Amoxicillin,between=[f'{index_date_variable}-1092days', f'{index_date_variable}-1063days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_35_Flucloxacillin=patients.with_these_medications(codes_ab_type_Amoxicillin,between=[f'{index_date_variable}-1092days', f'{index_date_variable}-1063days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_35_Nitrofurantoin=patients.with_these_medications(codes_ab_type_Amoxicillin,between=[f'{index_date_variable}-1092days', f'{index_date_variable}-1063days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_35_Phenoxymethylpenicillin=patients.with_these_medications(codes_ab_type_Amoxicillin,between=[f'{index_date_variable}-1092days', f'{index_date_variable}-1063days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_35_Trimethoprim=patients.with_these_medications(codes_ab_type_Amoxicillin,between=[f'{index_date_variable}-1092days', f'{index_date_variable}-1063days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_36_Amoxicillin=patients.with_these_medications(codes_ab_type_Amoxicillin,between=[f'{index_date_variable}-1122days', f'{index_date_variable}-1093days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_36_Azithromycin=patients.with_these_medications(codes_ab_type_Amoxicillin,between=[f'{index_date_variable}-1122days', f'{index_date_variable}-1093days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_36_Cefalexin=patients.with_these_medications(codes_ab_type_Amoxicillin,between=[f'{index_date_variable}-1122days', f'{index_date_variable}-1093days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_36_Ciprofloxacin=patients.with_these_medications(codes_ab_type_Amoxicillin,between=[f'{index_date_variable}-1122days', f'{index_date_variable}-1093days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_36_Clarithromycin=patients.with_these_medications(codes_ab_type_Amoxicillin,between=[f'{index_date_variable}-1122days', f'{index_date_variable}-1093days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_36_Co_amoxiclav=patients.with_these_medications(codes_ab_type_Amoxicillin,between=[f'{index_date_variable}-1122days', f'{index_date_variable}-1093days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_36_Doxycycline=patients.with_these_medications(codes_ab_type_Amoxicillin,between=[f'{index_date_variable}-1122days', f'{index_date_variable}-1093days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_36_Flucloxacillin=patients.with_these_medications(codes_ab_type_Amoxicillin,between=[f'{index_date_variable}-1122days', f'{index_date_variable}-1093days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_36_Nitrofurantoin=patients.with_these_medications(codes_ab_type_Amoxicillin,between=[f'{index_date_variable}-1122days', f'{index_date_variable}-1093days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_36_Phenoxymethylpenicillin=patients.with_these_medications(codes_ab_type_Amoxicillin,between=[f'{index_date_variable}-1122days', f'{index_date_variable}-1093days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_36_Trimethoprim=patients.with_these_medications(codes_ab_type_Amoxicillin,between=[f'{index_date_variable}-1122days', f'{index_date_variable}-1093days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),    # ## number of total prescriptions 
    # ab_prescriptions=patients.with_these_medications(
    #     antibacterials_codes_brit,
    #     between=[f'{index_date_variable}- 1137 days', f'{index_date_variable}- 42 days'],
    #     returning="number_of_matches_in_period",
    #     return_expectations={
    #         "int": {"distribution": "normal", "mean": 3, "stddev": 1},
    #         "incidence": 0.5,
    #     },
    # ),
    
    # ## time period ab prescriptions 
    # ab_first_date=patients.with_these_medications(
    #     antibacterials_codes_brit,
    #     between=[f'{index_date_variable}- 1137 days', f'{index_date_variable}- 42 days'],
    #     returning="date",
    #     find_first_match_in_period=True,  
    #     date_format="YYYY-MM-DD",  
    #     return_expectations={"date": {"earliest": "2020-03-01"}, "incidence" : 0.5},
    # ),

    # ab_last_date=patients.with_these_medications(
    #     antibacterials_codes_brit,
    #     between=[f'{index_date_variable}- 1137 days', f'{index_date_variable}- 42 days'],
    #     returning="date",
    #     find_last_match_in_period=True,  
    #     date_format="YYYY-MM-DD",  
    #     return_expectations={"date": {"earliest": "2020-03-01"}, "incidence" : 0.5},
    # ),


    ## number of broad-spectrum ab prescriptions
   
    broad_ab_prescriptions=patients.with_these_medications(
        broad_spectrum_antibiotics_codes,
        between=[f'{index_date_variable}- 1137 days', f'{index_date_variable}- 42 days'],
        returning="number_of_matches_in_period",
        return_expectations={
            "int": {"distribution": "normal", "mean": 3, "stddev": 1},
            "incidence": 0.5,
        },
    ),

    ## time difference

  )
    return antibiotics_yr3


