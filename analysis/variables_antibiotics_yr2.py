from cohortextractor import filter_codes_by_category, patients, combine_codelists
from codelists import *
from datetime import datetime, timedelta

def generate_antibiotics_yr2(index_date_variable):
    antibiotics_yr2 = dict(

# select top 11 common ab


# 2 yr before index
Rx_13_Amoxicillin=patients.with_these_medications(codes_ab_type_Amoxicillin,between=[f'{index_date_variable}-432days', f'{index_date_variable}-403days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_13_Azithromycin=patients.with_these_medications(codes_ab_type_Azithromycin,between=[f'{index_date_variable}-432days', f'{index_date_variable}-403days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_13_Cefalexin=patients.with_these_medications(codes_ab_type_Cefalexin,between=[f'{index_date_variable}-432days', f'{index_date_variable}-403days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_13_Ciprofloxacin=patients.with_these_medications(codes_ab_type_Ciprofloxacin,between=[f'{index_date_variable}-432days', f'{index_date_variable}-403days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_13_Clarithromycin=patients.with_these_medications(codes_ab_type_Clarithromycin,between=[f'{index_date_variable}-432days', f'{index_date_variable}-403days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_13_Co_amoxiclav=patients.with_these_medications(codes_ab_type_Co_amoxiclav,between=[f'{index_date_variable}-432days', f'{index_date_variable}-403days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_13_Doxycycline=patients.with_these_medications(codes_ab_type_Doxycycline,between=[f'{index_date_variable}-432days', f'{index_date_variable}-403days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_13_Flucloxacillin=patients.with_these_medications(codes_ab_type_Flucloxacillin,between=[f'{index_date_variable}-432days', f'{index_date_variable}-403days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_13_Nitrofurantoin=patients.with_these_medications(codes_ab_type_Nitrofurantoin,between=[f'{index_date_variable}-432days', f'{index_date_variable}-403days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_13_Phenoxymethylpenicillin=patients.with_these_medications(codes_ab_type_Phenoxymethylpenicillin,between=[f'{index_date_variable}-432days', f'{index_date_variable}-403days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_13_Trimethoprim=patients.with_these_medications(codes_ab_type_Trimethoprim,between=[f'{index_date_variable}-432days', f'{index_date_variable}-403days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_14_Amoxicillin=patients.with_these_medications(codes_ab_type_Amoxicillin,between=[f'{index_date_variable}-462days', f'{index_date_variable}-433days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_14_Azithromycin=patients.with_these_medications(codes_ab_type_Azithromycin,between=[f'{index_date_variable}-462days', f'{index_date_variable}-433days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_14_Cefalexin=patients.with_these_medications(codes_ab_type_Cefalexin,between=[f'{index_date_variable}-462days', f'{index_date_variable}-433days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_14_Ciprofloxacin=patients.with_these_medications(codes_ab_type_Ciprofloxacin,between=[f'{index_date_variable}-462days', f'{index_date_variable}-433days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_14_Clarithromycin=patients.with_these_medications(codes_ab_type_Clarithromycin,between=[f'{index_date_variable}-462days', f'{index_date_variable}-433days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_14_Co_amoxiclav=patients.with_these_medications(codes_ab_type_Co_amoxiclav,between=[f'{index_date_variable}-462days', f'{index_date_variable}-433days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_14_Doxycycline=patients.with_these_medications(codes_ab_type_Doxycycline,between=[f'{index_date_variable}-462days', f'{index_date_variable}-433days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_14_Flucloxacillin=patients.with_these_medications(codes_ab_type_Flucloxacillin,between=[f'{index_date_variable}-462days', f'{index_date_variable}-433days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_14_Nitrofurantoin=patients.with_these_medications(codes_ab_type_Nitrofurantoin,between=[f'{index_date_variable}-462days', f'{index_date_variable}-433days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_14_Phenoxymethylpenicillin=patients.with_these_medications(codes_ab_type_Phenoxymethylpenicillin,between=[f'{index_date_variable}-462days', f'{index_date_variable}-433days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_14_Trimethoprim=patients.with_these_medications(codes_ab_type_Trimethoprim,between=[f'{index_date_variable}-462days', f'{index_date_variable}-433days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_15_Amoxicillin=patients.with_these_medications(codes_ab_type_Amoxicillin,between=[f'{index_date_variable}-492days', f'{index_date_variable}-463days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_15_Azithromycin=patients.with_these_medications(codes_ab_type_Azithromycin,between=[f'{index_date_variable}-492days', f'{index_date_variable}-463days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_15_Cefalexin=patients.with_these_medications(codes_ab_type_Cefalexin,between=[f'{index_date_variable}-492days', f'{index_date_variable}-463days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_15_Ciprofloxacin=patients.with_these_medications(codes_ab_type_Ciprofloxacin,between=[f'{index_date_variable}-492days', f'{index_date_variable}-463days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_15_Clarithromycin=patients.with_these_medications(codes_ab_type_Clarithromycin,between=[f'{index_date_variable}-492days', f'{index_date_variable}-463days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_15_Co_amoxiclav=patients.with_these_medications(codes_ab_type_Co_amoxiclav,between=[f'{index_date_variable}-492days', f'{index_date_variable}-463days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_15_Doxycycline=patients.with_these_medications(codes_ab_type_Doxycycline,between=[f'{index_date_variable}-492days', f'{index_date_variable}-463days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_15_Flucloxacillin=patients.with_these_medications(codes_ab_type_Flucloxacillin,between=[f'{index_date_variable}-492days', f'{index_date_variable}-463days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_15_Nitrofurantoin=patients.with_these_medications(codes_ab_type_Nitrofurantoin,between=[f'{index_date_variable}-492days', f'{index_date_variable}-463days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_15_Phenoxymethylpenicillin=patients.with_these_medications(codes_ab_type_Phenoxymethylpenicillin,between=[f'{index_date_variable}-492days', f'{index_date_variable}-463days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_15_Trimethoprim=patients.with_these_medications(codes_ab_type_Trimethoprim,between=[f'{index_date_variable}-492days', f'{index_date_variable}-463days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_16_Amoxicillin=patients.with_these_medications(codes_ab_type_Amoxicillin,between=[f'{index_date_variable}-522days', f'{index_date_variable}-493days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_16_Azithromycin=patients.with_these_medications(codes_ab_type_Azithromycin,between=[f'{index_date_variable}-522days', f'{index_date_variable}-493days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_16_Cefalexin=patients.with_these_medications(codes_ab_type_Cefalexin,between=[f'{index_date_variable}-522days', f'{index_date_variable}-493days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_16_Ciprofloxacin=patients.with_these_medications(codes_ab_type_Ciprofloxacin,between=[f'{index_date_variable}-522days', f'{index_date_variable}-493days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_16_Clarithromycin=patients.with_these_medications(codes_ab_type_Clarithromycin,between=[f'{index_date_variable}-522days', f'{index_date_variable}-493days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_16_Co_amoxiclav=patients.with_these_medications(codes_ab_type_Co_amoxiclav,between=[f'{index_date_variable}-522days', f'{index_date_variable}-493days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_16_Doxycycline=patients.with_these_medications(codes_ab_type_Doxycycline,between=[f'{index_date_variable}-522days', f'{index_date_variable}-493days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_16_Flucloxacillin=patients.with_these_medications(codes_ab_type_Flucloxacillin,between=[f'{index_date_variable}-522days', f'{index_date_variable}-493days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_16_Nitrofurantoin=patients.with_these_medications(codes_ab_type_Nitrofurantoin,between=[f'{index_date_variable}-522days', f'{index_date_variable}-493days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_16_Phenoxymethylpenicillin=patients.with_these_medications(codes_ab_type_Phenoxymethylpenicillin,between=[f'{index_date_variable}-522days', f'{index_date_variable}-493days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_16_Trimethoprim=patients.with_these_medications(codes_ab_type_Trimethoprim,between=[f'{index_date_variable}-522days', f'{index_date_variable}-493days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_17_Amoxicillin=patients.with_these_medications(codes_ab_type_Amoxicillin,between=[f'{index_date_variable}-552days', f'{index_date_variable}-523days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_17_Azithromycin=patients.with_these_medications(codes_ab_type_Azithromycin,between=[f'{index_date_variable}-552days', f'{index_date_variable}-523days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_17_Cefalexin=patients.with_these_medications(codes_ab_type_Cefalexin,between=[f'{index_date_variable}-552days', f'{index_date_variable}-523days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_17_Ciprofloxacin=patients.with_these_medications(codes_ab_type_Ciprofloxacin,between=[f'{index_date_variable}-552days', f'{index_date_variable}-523days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_17_Clarithromycin=patients.with_these_medications(codes_ab_type_Clarithromycin,between=[f'{index_date_variable}-552days', f'{index_date_variable}-523days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_17_Co_amoxiclav=patients.with_these_medications(codes_ab_type_Co_amoxiclav,between=[f'{index_date_variable}-552days', f'{index_date_variable}-523days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_17_Doxycycline=patients.with_these_medications(codes_ab_type_Doxycycline,between=[f'{index_date_variable}-552days', f'{index_date_variable}-523days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_17_Flucloxacillin=patients.with_these_medications(codes_ab_type_Flucloxacillin,between=[f'{index_date_variable}-552days', f'{index_date_variable}-523days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_17_Nitrofurantoin=patients.with_these_medications(codes_ab_type_Nitrofurantoin,between=[f'{index_date_variable}-552days', f'{index_date_variable}-523days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_17_Phenoxymethylpenicillin=patients.with_these_medications(codes_ab_type_Phenoxymethylpenicillin,between=[f'{index_date_variable}-552days', f'{index_date_variable}-523days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_17_Trimethoprim=patients.with_these_medications(codes_ab_type_Trimethoprim,between=[f'{index_date_variable}-552days', f'{index_date_variable}-523days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_18_Amoxicillin=patients.with_these_medications(codes_ab_type_Amoxicillin,between=[f'{index_date_variable}-582days', f'{index_date_variable}-553days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_18_Azithromycin=patients.with_these_medications(codes_ab_type_Azithromycin,between=[f'{index_date_variable}-582days', f'{index_date_variable}-553days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_18_Cefalexin=patients.with_these_medications(codes_ab_type_Cefalexin,between=[f'{index_date_variable}-582days', f'{index_date_variable}-553days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_18_Ciprofloxacin=patients.with_these_medications(codes_ab_type_Ciprofloxacin,between=[f'{index_date_variable}-582days', f'{index_date_variable}-553days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_18_Clarithromycin=patients.with_these_medications(codes_ab_type_Clarithromycin,between=[f'{index_date_variable}-582days', f'{index_date_variable}-553days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_18_Co_amoxiclav=patients.with_these_medications(codes_ab_type_Co_amoxiclav,between=[f'{index_date_variable}-582days', f'{index_date_variable}-553days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_18_Doxycycline=patients.with_these_medications(codes_ab_type_Doxycycline,between=[f'{index_date_variable}-582days', f'{index_date_variable}-553days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_18_Flucloxacillin=patients.with_these_medications(codes_ab_type_Flucloxacillin,between=[f'{index_date_variable}-582days', f'{index_date_variable}-553days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_18_Nitrofurantoin=patients.with_these_medications(codes_ab_type_Nitrofurantoin,between=[f'{index_date_variable}-582days', f'{index_date_variable}-553days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_18_Phenoxymethylpenicillin=patients.with_these_medications(codes_ab_type_Phenoxymethylpenicillin,between=[f'{index_date_variable}-582days', f'{index_date_variable}-553days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_18_Trimethoprim=patients.with_these_medications(codes_ab_type_Trimethoprim,between=[f'{index_date_variable}-582days', f'{index_date_variable}-553days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_19_Amoxicillin=patients.with_these_medications(codes_ab_type_Amoxicillin,between=[f'{index_date_variable}-612days', f'{index_date_variable}-583days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_19_Azithromycin=patients.with_these_medications(codes_ab_type_Azithromycin,between=[f'{index_date_variable}-612days', f'{index_date_variable}-583days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_19_Cefalexin=patients.with_these_medications(codes_ab_type_Cefalexin,between=[f'{index_date_variable}-612days', f'{index_date_variable}-583days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_19_Ciprofloxacin=patients.with_these_medications(codes_ab_type_Ciprofloxacin,between=[f'{index_date_variable}-612days', f'{index_date_variable}-583days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_19_Clarithromycin=patients.with_these_medications(codes_ab_type_Clarithromycin,between=[f'{index_date_variable}-612days', f'{index_date_variable}-583days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_19_Co_amoxiclav=patients.with_these_medications(codes_ab_type_Co_amoxiclav,between=[f'{index_date_variable}-612days', f'{index_date_variable}-583days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_19_Doxycycline=patients.with_these_medications(codes_ab_type_Doxycycline,between=[f'{index_date_variable}-612days', f'{index_date_variable}-583days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_19_Flucloxacillin=patients.with_these_medications(codes_ab_type_Flucloxacillin,between=[f'{index_date_variable}-612days', f'{index_date_variable}-583days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_19_Nitrofurantoin=patients.with_these_medications(codes_ab_type_Nitrofurantoin,between=[f'{index_date_variable}-612days', f'{index_date_variable}-583days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_19_Phenoxymethylpenicillin=patients.with_these_medications(codes_ab_type_Phenoxymethylpenicillin,between=[f'{index_date_variable}-612days', f'{index_date_variable}-583days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_19_Trimethoprim=patients.with_these_medications(codes_ab_type_Trimethoprim,between=[f'{index_date_variable}-612days', f'{index_date_variable}-583days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_20_Amoxicillin=patients.with_these_medications(codes_ab_type_Amoxicillin,between=[f'{index_date_variable}-642days', f'{index_date_variable}-613days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_20_Azithromycin=patients.with_these_medications(codes_ab_type_Azithromycin,between=[f'{index_date_variable}-642days', f'{index_date_variable}-613days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_20_Cefalexin=patients.with_these_medications(codes_ab_type_Cefalexin,between=[f'{index_date_variable}-642days', f'{index_date_variable}-613days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_20_Ciprofloxacin=patients.with_these_medications(codes_ab_type_Ciprofloxacin,between=[f'{index_date_variable}-642days', f'{index_date_variable}-613days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_20_Clarithromycin=patients.with_these_medications(codes_ab_type_Clarithromycin,between=[f'{index_date_variable}-642days', f'{index_date_variable}-613days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_20_Co_amoxiclav=patients.with_these_medications(codes_ab_type_Co_amoxiclav,between=[f'{index_date_variable}-642days', f'{index_date_variable}-613days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_20_Doxycycline=patients.with_these_medications(codes_ab_type_Doxycycline,between=[f'{index_date_variable}-642days', f'{index_date_variable}-613days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_20_Flucloxacillin=patients.with_these_medications(codes_ab_type_Flucloxacillin,between=[f'{index_date_variable}-642days', f'{index_date_variable}-613days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_20_Nitrofurantoin=patients.with_these_medications(codes_ab_type_Nitrofurantoin,between=[f'{index_date_variable}-642days', f'{index_date_variable}-613days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_20_Phenoxymethylpenicillin=patients.with_these_medications(codes_ab_type_Phenoxymethylpenicillin,between=[f'{index_date_variable}-642days', f'{index_date_variable}-613days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_20_Trimethoprim=patients.with_these_medications(codes_ab_type_Trimethoprim,between=[f'{index_date_variable}-642days', f'{index_date_variable}-613days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_21_Amoxicillin=patients.with_these_medications(codes_ab_type_Amoxicillin,between=[f'{index_date_variable}-672days', f'{index_date_variable}-643days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_21_Azithromycin=patients.with_these_medications(codes_ab_type_Azithromycin,between=[f'{index_date_variable}-672days', f'{index_date_variable}-643days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_21_Cefalexin=patients.with_these_medications(codes_ab_type_Cefalexin,between=[f'{index_date_variable}-672days', f'{index_date_variable}-643days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_21_Ciprofloxacin=patients.with_these_medications(codes_ab_type_Ciprofloxacin,between=[f'{index_date_variable}-672days', f'{index_date_variable}-643days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_21_Clarithromycin=patients.with_these_medications(codes_ab_type_Clarithromycin,between=[f'{index_date_variable}-672days', f'{index_date_variable}-643days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_21_Co_amoxiclav=patients.with_these_medications(codes_ab_type_Co_amoxiclav,between=[f'{index_date_variable}-672days', f'{index_date_variable}-643days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_21_Doxycycline=patients.with_these_medications(codes_ab_type_Doxycycline,between=[f'{index_date_variable}-672days', f'{index_date_variable}-643days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_21_Flucloxacillin=patients.with_these_medications(codes_ab_type_Flucloxacillin,between=[f'{index_date_variable}-672days', f'{index_date_variable}-643days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_21_Nitrofurantoin=patients.with_these_medications(codes_ab_type_Nitrofurantoin,between=[f'{index_date_variable}-672days', f'{index_date_variable}-643days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_21_Phenoxymethylpenicillin=patients.with_these_medications(codes_ab_type_Phenoxymethylpenicillin,between=[f'{index_date_variable}-672days', f'{index_date_variable}-643days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_21_Trimethoprim=patients.with_these_medications(codes_ab_type_Trimethoprim,between=[f'{index_date_variable}-672days', f'{index_date_variable}-643days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_22_Amoxicillin=patients.with_these_medications(codes_ab_type_Amoxicillin,between=[f'{index_date_variable}-702days', f'{index_date_variable}-673days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_22_Azithromycin=patients.with_these_medications(codes_ab_type_Azithromycin,between=[f'{index_date_variable}-702days', f'{index_date_variable}-673days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_22_Cefalexin=patients.with_these_medications(codes_ab_type_Cefalexin,between=[f'{index_date_variable}-702days', f'{index_date_variable}-673days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_22_Ciprofloxacin=patients.with_these_medications(codes_ab_type_Ciprofloxacin,between=[f'{index_date_variable}-702days', f'{index_date_variable}-673days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_22_Clarithromycin=patients.with_these_medications(codes_ab_type_Clarithromycin,between=[f'{index_date_variable}-702days', f'{index_date_variable}-673days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_22_Co_amoxiclav=patients.with_these_medications(codes_ab_type_Co_amoxiclav,between=[f'{index_date_variable}-702days', f'{index_date_variable}-673days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_22_Doxycycline=patients.with_these_medications(codes_ab_type_Doxycycline,between=[f'{index_date_variable}-702days', f'{index_date_variable}-673days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_22_Flucloxacillin=patients.with_these_medications(codes_ab_type_Flucloxacillin,between=[f'{index_date_variable}-702days', f'{index_date_variable}-673days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_22_Nitrofurantoin=patients.with_these_medications(codes_ab_type_Nitrofurantoin,between=[f'{index_date_variable}-702days', f'{index_date_variable}-673days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_22_Phenoxymethylpenicillin=patients.with_these_medications(codes_ab_type_Phenoxymethylpenicillin,between=[f'{index_date_variable}-702days', f'{index_date_variable}-673days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_22_Trimethoprim=patients.with_these_medications(codes_ab_type_Trimethoprim,between=[f'{index_date_variable}-702days', f'{index_date_variable}-673days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_23_Amoxicillin=patients.with_these_medications(codes_ab_type_Amoxicillin,between=[f'{index_date_variable}-732days', f'{index_date_variable}-703days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_23_Azithromycin=patients.with_these_medications(codes_ab_type_Azithromycin,between=[f'{index_date_variable}-732days', f'{index_date_variable}-703days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_23_Cefalexin=patients.with_these_medications(codes_ab_type_Cefalexin,between=[f'{index_date_variable}-732days', f'{index_date_variable}-703days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_23_Ciprofloxacin=patients.with_these_medications(codes_ab_type_Ciprofloxacin,between=[f'{index_date_variable}-732days', f'{index_date_variable}-703days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_23_Clarithromycin=patients.with_these_medications(codes_ab_type_Clarithromycin,between=[f'{index_date_variable}-732days', f'{index_date_variable}-703days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_23_Co_amoxiclav=patients.with_these_medications(codes_ab_type_Co_amoxiclav,between=[f'{index_date_variable}-732days', f'{index_date_variable}-703days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_23_Doxycycline=patients.with_these_medications(codes_ab_type_Doxycycline,between=[f'{index_date_variable}-732days', f'{index_date_variable}-703days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_23_Flucloxacillin=patients.with_these_medications(codes_ab_type_Flucloxacillin,between=[f'{index_date_variable}-732days', f'{index_date_variable}-703days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_23_Nitrofurantoin=patients.with_these_medications(codes_ab_type_Nitrofurantoin,between=[f'{index_date_variable}-732days', f'{index_date_variable}-703days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_23_Phenoxymethylpenicillin=patients.with_these_medications(codes_ab_type_Phenoxymethylpenicillin,between=[f'{index_date_variable}-732days', f'{index_date_variable}-703days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_23_Trimethoprim=patients.with_these_medications(codes_ab_type_Trimethoprim,between=[f'{index_date_variable}-732days', f'{index_date_variable}-703days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_24_Amoxicillin=patients.with_these_medications(codes_ab_type_Amoxicillin,between=[f'{index_date_variable}-762days', f'{index_date_variable}-733days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_24_Azithromycin=patients.with_these_medications(codes_ab_type_Azithromycin,between=[f'{index_date_variable}-762days', f'{index_date_variable}-733days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_24_Cefalexin=patients.with_these_medications(codes_ab_type_Cefalexin,between=[f'{index_date_variable}-762days', f'{index_date_variable}-733days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_24_Ciprofloxacin=patients.with_these_medications(codes_ab_type_Ciprofloxacin,between=[f'{index_date_variable}-762days', f'{index_date_variable}-733days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_24_Clarithromycin=patients.with_these_medications(codes_ab_type_Clarithromycin,between=[f'{index_date_variable}-762days', f'{index_date_variable}-733days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_24_Co_amoxiclav=patients.with_these_medications(codes_ab_type_Co_amoxiclav,between=[f'{index_date_variable}-762days', f'{index_date_variable}-733days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_24_Doxycycline=patients.with_these_medications(codes_ab_type_Doxycycline,between=[f'{index_date_variable}-762days', f'{index_date_variable}-733days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_24_Flucloxacillin=patients.with_these_medications(codes_ab_type_Flucloxacillin,between=[f'{index_date_variable}-762days', f'{index_date_variable}-733days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_24_Nitrofurantoin=patients.with_these_medications(codes_ab_type_Nitrofurantoin,between=[f'{index_date_variable}-762days', f'{index_date_variable}-733days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_24_Phenoxymethylpenicillin=patients.with_these_medications(codes_ab_type_Phenoxymethylpenicillin,between=[f'{index_date_variable}-762days', f'{index_date_variable}-733days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
Rx_24_Trimethoprim=patients.with_these_medications(codes_ab_type_Trimethoprim,between=[f'{index_date_variable}-762days', f'{index_date_variable}-733days'],returning='number_of_matches_in_period',return_expectations={'int': {'distribution': 'normal', 'mean': 3, 'stddev': 1},'incidence': 0.5,}),
        
    # ## number of total prescriptions 
    # ab_prescriptions=patients.with_these_medications(
    #     antibacterials_codes_brit,
    #     between=[f'{index_date_variable}- 1137 days', f'{index_date_variable}- 42 days'],
    #     returning="number_of_matches_in_period",
    #     return_expectations={
    #         "int": {"distribution": "normal", "mean": 3, "stddev": 1},
    #         "incidence": 0.5,
    #     },
    # ),
    
    # ## time period ab prescriptions 
    # ab_first_date=patients.with_these_medications(
    #     antibacterials_codes_brit,
    #     between=[f'{index_date_variable}- 1137 days', f'{index_date_variable}- 42 days'],
    #     returning="date",
    #     find_first_match_in_period=True,  
    #     date_format="YYYY-MM-DD",  
    #     return_expectations={"date": {"earliest": "2020-03-01"}, "incidence" : 0.5},
    # ),

    # ab_last_date=patients.with_these_medications(
    #     antibacterials_codes_brit,
    #     between=[f'{index_date_variable}- 1137 days', f'{index_date_variable}- 42 days'],
    #     returning="date",
    #     find_last_match_in_period=True,  
    #     date_format="YYYY-MM-DD",  
    #     return_expectations={"date": {"earliest": "2020-03-01"}, "incidence" : 0.5},
    # ),


    ## number of broad-spectrum ab prescriptions
   
    broad_ab_prescriptions=patients.with_these_medications(
        broad_spectrum_antibiotics_codes,
        between=[f'{index_date_variable}- 1137 days', f'{index_date_variable}- 42 days'],
        returning="number_of_matches_in_period",
        return_expectations={
            "int": {"distribution": "normal", "mean": 3, "stddev": 1},
            "incidence": 0.5,
        },
    ),

    ## time difference

  )
    return antibiotics_yr2


