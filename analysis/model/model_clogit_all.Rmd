---
title: "conditional logistic regression: adjusted model"
---

```{r setup, include=FALSE}
#library(knitr)
library(dplyr)
#library(skimr)
library('tidyverse')
require("gtsummary")
library("survival")
library(car)
library(finalfit)
```


# general

```{r }
data=readRDS(here::here("output","study_1.rds"))
data=data%>%ungroup(subclass)

data$quintile=as.factor(data$quintile)
data$subclass=as.factor(data$subclass)#pair id

data$CCI= relevel(as.factor(data$CCI), ref="Zero")
data$covrx_ever= relevel(as.factor(data$covrx_ever), ref="0")

data$bmi_cat=relevel(as.factor(data$bmi_cat),ref="Healthy weight")
data$care_home=relevel(as.factor(data$care_home),ref = "0")

data$flu_vaccine=relevel(as.factor(data$flu_vaccine),ref= "0")

data$smoking_cat_3=relevel(as.factor(data$smoking_cat_3),ref="Never")
data$imd=relevel(as.factor(data$imd),ref="1")
data$ethnicity_6=relevel(as.factor(data$ethnicity_6),ref = "White")

data$case=as.numeric(data$case) #1/0

str(data)
```


```{r eval=FALSE, include=FALSE}
model=clogit(case ~ quintile+ CCI + covrx_ever + bmi_cat + care_home + flu_vaccine + smoking_cat_3 + imd+ ethnicity_6 + strata(subclass),data) 
summary(model)

```



# hosp
```{r eval=FALSE, include=FALSE}
data=readRDS(here::here("output","study_2.rds"))

data$quintile=as.factor(data$quintile)
data$subclass=as.factor(data$subclass)#pair id

data$case=as.numeric(data$case) #1/0
model=clogit(case ~ quintile+ CCI + covrx_ever + bmi_cat + care_home + flu_vaccine + smoking_cat_3 + imd+ ethnicity_6 + strata(subclass),data) 
summary(model)
```


# death
##  crude model
```{r eval=FALSE, include=FALSE}
data=readRDS(here::here("output","study_3.rds"))

data$quintile=as.factor(data$quintile)
data$subclass=as.factor(data$subclass)#pair id

data$case=as.numeric(data$case) #1/0
model=clogit(case ~ quintile+ CCI + covrx_ever + bmi_cat + care_home + flu_vaccine + smoking_cat_3 + imd+ ethnicity_6 + strata(subclass),data) 
summary(model)
```




