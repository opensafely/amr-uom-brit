---
title: " patient selection flowchart"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(include = FALSE)
#library(knitr)
library(dplyr)
```

# hospital admission
```{r}
df <- read.csv(here::here("output","input_covid_admission.csv"))
N=nrow(df)
round(N/5)*5
```


# primary care
```{r}
df1 <- read.csv(here::here("output","input_covid_primarycare.csv"))
N=nrow(df1)
round(N/5)*5
```

# SGSS
```{r}
df2 <- read.csv(here::here("output","input_covid_SGSS.csv"))
N=nrow(df2)
round(N/5)*5
```


## covid infection (merged primary+SGSS)
```{r}
df=rbind(df1,df2)


# keep earlist covid infection date
df=df%>%
  group_by(patient_id)%>%
  arrange(patient_id,patient_index_date)%>%
  distinct(patient_id, .keep_all = TRUE)


N=nrow(df)
round(N/5)*5

```


# control
```{r}
df <- read.csv(here::here("output","control_covid_infection.csv"))
N=nrow(df)
round(N/5)*5
```

# case
```{r}
df <- read.csv(here::here("output","case_covid_hosp.csv"))
N=nrow(df)
round(N/5)*5
```


# matching (case vs. control)
```{r}
df=readRDS(here::here("output","matched_ab.rds"))
round(table(df$case)/5)*5
```

