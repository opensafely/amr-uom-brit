---
title: "classification comparison: RF "
---

```{r setup, include=FALSE}
library('tidyverse')

library('tidyverse')
library("ggplot2")
library("plyr")
library('dplyr')
library('lubridate')
library('stringr')
library("data.table")
library("ggpubr")
library("finalfit")

```

# import dataset
```{r }

train <- read_rds(here::here("output","development.rds"))
valid <- read_rds(here::here("output","validation.rds"))

```



# descriptive stat 
```{r}
data=train
data$decile=as.factor(data$decile)
# select variables
explanatory<- c("total_ab_group","ab_types_group","exposure_period_group","recent_ab_days_group","broad_ab_prescriptions_group","interval_mean_group","interval_sd_group")
dependent <- "decile"
tbl=data %>% summary_factorlist(dependent, explanatory)
tbl
```

# staked bar chart
```{r}
library(ggplot2)

for (i in 1:length(explanatory)) {
  
  tbl=data.frame(table(data[,"decile"],data[,explanatory[i]]))
  
  print(ggplot(data=tbl,aes(x=Var1,y=Freq, fill=Var2))+
 #  geom_col() +
    geom_bar(position="fill", stat="identity")+
 ggtitle(explanatory[i]))

}


```

```{r}
data=valid
data$decile=as.factor(data$decile)
# select variables
explanatory<- c("total_ab_group","ab_types_group","exposure_period_group","recent_ab_days_group","broad_ab_prescriptions_group","interval_mean_group","interval_sd_group")
dependent <- "decile"
tbl=data %>% summary_factorlist(dependent, explanatory)
tbl

```

```{r}

for (i in 1:length(explanatory)) {
  
  tbl=data.frame(table(data[,"decile"],data[,explanatory[i]]))
  
  print(ggplot(data=tbl,aes(x=Var1,y=Freq, fill=Var2))+
   geom_col() +
 ggtitle(explanatory[i]))

}

```
